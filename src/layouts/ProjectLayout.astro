---
import BaseLayout from './BaseLayout.astro';

interface Props {
  frontmatter: {
    title: string;
    description: string;
    company: string;
    period: string;
    role: string;
    responsibilities?: string[];
    context?: string;
    myJob?: string;
  };
  slug: string;
}

const { frontmatter, slug } = Astro.props;
---

<BaseLayout title={`${frontmatter.title} | Ivan Uruchurtu`} description={frontmatter.description}>
  <article class="py-12 relative">
    <a
      href="/"
      class="fade-stagger text-text-secondary hover:text-text-primary transition-colors text-sm absolute top-4"
      data-stagger="0"
    >
      &larr; Back
    </a>

    <header class="mb-12">
      <h1
        class="fade-stagger text-7xl font-display font-light text-text-primary mb-4 leading-[1.15]"
        data-stagger="1"
        style="font-variation-settings: 'opsz' 72, 'SOFT' 0, 'WONK' 1;"
      >
        {frontmatter.title}
      </h1>

      <!-- Metadata Row -->
      <div class="fade-stagger flex flex-wrap gap-12 mt-10" data-stagger="2">
        <div>
          <p class="text-xs uppercase tracking-[1.2px] text-text-secondary font-mono mb-2">Role</p>
          <p class="text-text-primary text-sm">{frontmatter.role}</p>
        </div>
        <div>
          <p class="text-xs uppercase tracking-[1.2px] text-text-secondary font-mono mb-2">Duration</p>
          <p class="text-text-primary text-sm">{frontmatter.period}</p>
        </div>
        {frontmatter.responsibilities && frontmatter.responsibilities.length > 0 && (
          <div class="ml-7">
            <p class="text-xs uppercase tracking-[1.2px] text-text-secondary font-mono mb-2">Responsibilities</p>
            <p class="text-text-primary text-sm" set:html={frontmatter.responsibilities.join(' &middot; ')} />
          </div>
        )}
      </div>

      <!-- Context & My Job -->
      {(frontmatter.context || frontmatter.myJob) && (
        <div class="fade-stagger flex flex-col gap-6 mt-10 max-w-2xl" data-stagger="3">
          {frontmatter.context && (
            <div>
              <p class="text-xs uppercase tracking-[1.2px] text-text-secondary font-mono mb-2">Context</p>
              <p class="text-text-primary text-base leading-relaxed">{frontmatter.context}</p>
            </div>
          )}
          {frontmatter.myJob && (
            <div>
              <p class="text-xs uppercase tracking-[1.2px] text-text-secondary font-mono mb-2">My Job</p>
              <p class="text-text-primary text-base leading-relaxed">{frontmatter.myJob}</p>
            </div>
          )}
        </div>
      )}
    </header>

    <div class="fade-stagger prose prose-invert prose-sm max-w-none project-content" data-stagger="4">
      <slot />
    </div>
  </article>
</BaseLayout>

<style>
  .project-content :global(h2) {
    font-family: var(--font-display);
    font-weight: 300;
    font-size: 2rem;
    line-height: 1.15;
    color: var(--color-text-primary);
  }

  .project-content :global(img) {
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    cursor: zoom-in;
  }

  .project-content :global(video) {
    width: 100%;
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }
</style>

<script>
  import mediumZoom from 'medium-zoom';

  function initZoom() {
    mediumZoom('.project-content img', {
      background: 'rgba(0, 0, 0, 0.9)',
      margin: 24,
    });
  }

  initZoom();
  document.addEventListener('astro:after-swap', initZoom);
</script>
